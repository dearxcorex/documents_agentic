"""Thai Government Document Templates - กสทช. Official Formats

This module contains:
1. DRAFT templates with [PLACEHOLDER] syntax for dynamic generation
2. EXAMPLE documents for reference/RAG context
3. PLACEHOLDERS metadata for validation
"""

from typing import Literal

# All available document types
TemplateType = Literal[
    # บันทึกข้อความ subtypes
    "ขออนุมัติเดินทาง",
    "รายงานตรวจคลื่นความถี่",
    "รายงานรับเสด็จ",
    "รายงานตรวจจัดสรร",
    "รายงานทุบทำลายเครื่อง",
    "รายงานตรวจสถานี",
    "รายงานสอบถามข้อมูล",
    "ใบปะหน้าขอทำลาย",
    "เชิญประชุม",
    "รายงานการประชุม",
    # หนังสือภายนอก subtypes
    "เชิญตรวจร่วม",
    "ขอรื้อถอนเสา",
    "ขอขยายสัญญาณ",
]

# =============================================================================
# DRAFT TEMPLATES WITH PLACEHOLDERS
# These are the templates agent will fill in with [PLACEHOLDER] replaced
# =============================================================================

# หนังสือภายใน - Pattern A: ขออนุมัติ/ขอพิจารณา
DRAFT_INTERNAL_REQUEST = """	บันทึกข้อความ

ส่วนราชการ   [AGENCY]	([DEPARTMENT])	   โทร. [PHONE]

ที่ 	[DOC_NUMBER]	วันที่ [DAY] [MONTH_THAI] [YEAR_THAI]

เรื่อง	[SUBJECT]

เรียน   	[RECIPIENT]

๑.	เรื่องเดิม

	ตามหนังสือ [REFERENCE_AGENCY] ที่ [REFERENCE_DOC_NUMBER] ลงวันที่ [REFERENCE_DATE] เรื่อง [REFERENCE_SUBJECT] ได้รับความเห็นชอบ[APPROVAL_DETAILS] รายละเอียดปรากฏตามเอกสารแนบ นั้น

๒.	เรื่องเพื่อพิจารณา

	๒.๑	เพื่อให้การปฏิบัติงานตามข้อ ๑. เป็นไปด้วยความเรียบร้อย จึงขออนุมัติ[REQUEST_ACTION] ระหว่างวันที่ [DATE_RANGE] ในเขตพื้นที่[LOCATION] โดยมีพนักงานดังนี้

	๒.๑.๑ [STAFF_1]
	๒.๑.๒ [STAFF_2]
	๒.๑.๓ [STAFF_3]

	จึงเรียนมาเพื่อโปรด[PURPOSE]
"""

# หนังสือภายใน - Pattern B: รายงานผล
DRAFT_INTERNAL_REPORT = """	บันทึกข้อความ

ส่วนราชการ   [AGENCY]	([DEPARTMENT])	   โทร. [PHONE]

ที่ 	[DOC_NUMBER]	วันที่ [DAY] [MONTH_THAI] [YEAR_THAI]

เรื่อง	[SUBJECT]

เรียน   	[RECIPIENT]

๑.	เรื่องเดิม

	ตามหนังสือ [REFERENCE_AGENCY] ที่ [REFERENCE_DOC_NUMBER] ลงวันที่ [REFERENCE_DATE] เรื่อง [REFERENCE_SUBJECT] รายละเอียดปรากฏตามเอกสารแนบ นั้น

๒.	ข้อเท็จจริง

	[FACTS_AND_FINDINGS]

	จึงเรียนมาเพื่อโปรด[PURPOSE]
"""

# หนังสือภายนอก - External Letter
DRAFT_EXTERNAL_LETTER = """[SENDER_ADDRESS]

[DATE_FULL]

เรื่อง [SUBJECT]

เรียน [RECIPIENT_FULL]

[REFERENCE_LINE]

[ATTACHMENT_LINE]

	[INTRO_PARAGRAPH]

	[BODY_PARAGRAPHS]

	จึงเรียนมาเพื่อโปรด[PURPOSE]

ขอแสดงความนับถือ


([SIGNER_NAME])
[SIGNER_POSITION]

[CONTACT_INFO]
"""

# รายงานการประชุม - Meeting Minutes
DRAFT_MEETING_MINUTES = """รายงานการประชุม

[COMMITTEE_NAME]

ครั้งที่ [MEETING_NUMBER] ในวัน[DAY_OF_WEEK]ที่ [DATE_FULL]

ณ [MEETING_LOCATION]

ผู้เข้าประชุม
[ATTENDEES_LIST]

เริ่มประชุมเวลา  [START_TIME] น.

ประธาน กล่าวเปิดการประชุม ตามระเบียบวาระ ดังนี้

ระเบียบวาระที่ ๑ เรื่องที่ประธานแจ้งให้ที่ประชุมทราบ
[AGENDA_1_CONTENT]

มติที่ประชุม	[RESOLUTION_1]

ระเบียบวาระที่ ๒ เรื่องรับรองรายงานการประชุม
[AGENDA_2_CONTENT]

มติที่ประชุม  	[RESOLUTION_2]

ระเบียบวาระที่ ๓ เรื่องเสนอเพื่อทราบและพิจารณา
[AGENDA_3_CONTENT]

มติที่ประชุม	[RESOLUTION_3]

ระเบียบวาระที่ ๔ เรื่องอื่น ๆ พิจารณา
[AGENDA_4_CONTENT]

มติที่ประชุม	[RESOLUTION_4]

เลิกประชุมเวลา [END_TIME] น.
"""

# =============================================================================
# PLACEHOLDER METADATA
# Defines what each placeholder means and whether it's required
# =============================================================================

PLACEHOLDERS = {
    # Common fields
    "AGENCY": {
        "description": "ชื่อหน่วยงานที่ออกหนังสือ",
        "example": "สำนักงาน กสทช. เขต 23",
        "required": True,
        "category": ["หนังสือภายใน"],
    },
    "DEPARTMENT": {
        "description": "ส่วนงานย่อย",
        "example": "ส่วนตรวจสอบและกำกับดูแล",
        "required": False,
        "category": ["หนังสือภายใน"],
    },
    "PHONE": {
        "description": "หมายเลขโทรศัพท์ติดต่อ",
        "example": "4348",
        "required": False,
        "category": ["หนังสือภายใน", "หนังสือภายนอก"],
    },
    "DOC_NUMBER": {
        "description": "เลขที่หนังสือ",
        "example": "สทช 2203.3/",
        "required": True,
        "category": ["หนังสือภายใน", "หนังสือภายนอก"],
    },
    "DAY": {
        "description": "วันที่ (ตัวเลข)",
        "example": "15",
        "required": True,
        "category": ["หนังสือภายใน", "หนังสือภายนอก", "รายงานการประชุม"],
    },
    "MONTH_THAI": {
        "description": "เดือน (ภาษาไทย)",
        "example": "มกราคม",
        "required": True,
        "category": ["หนังสือภายใน"],
    },
    "YEAR_THAI": {
        "description": "ปี พ.ศ.",
        "example": "๒๕๖๘",
        "required": True,
        "category": ["หนังสือภายใน"],
    },
    "DATE_FULL": {
        "description": "วันที่เต็ม",
        "example": "๗ กุมภาพันธ์ ๒๕๖๘",
        "required": True,
        "category": ["หนังสือภายนอก", "รายงานการประชุม"],
    },
    "SUBJECT": {
        "description": "หัวข้อเรื่อง",
        "example": "ขออนุมัติเดินทางไปปฏิบัติงานนอกที่ตั้ง",
        "required": True,
        "category": ["หนังสือภายใน", "หนังสือภายนอก"],
    },
    "RECIPIENT": {
        "description": "ผู้รับหนังสือ (ภายใน)",
        "example": "ผภภ. 23",
        "required": True,
        "category": ["หนังสือภายใน"],
    },
    "RECIPIENT_FULL": {
        "description": "ผู้รับหนังสือ (ภายนอก) พร้อมตำแหน่ง",
        "example": "กรรมการผู้จัดการใหญ่บริษัท โทรคมนาคมแห่งชาติจำกัด (มหาชน)",
        "required": True,
        "category": ["หนังสือภายนอก"],
    },
    "REFERENCE_AGENCY": {
        "description": "หน่วยงานที่อ้างอิง",
        "example": "สำนักงาน กสทช. เขต 23",
        "required": True,
        "category": ["หนังสือภายใน"],
    },
    "REFERENCE_DOC_NUMBER": {
        "description": "เลขที่หนังสืออ้างอิง",
        "example": "สทช 2203/12",
        "required": True,
        "category": ["หนังสือภายใน"],
    },
    "REFERENCE_DATE": {
        "description": "วันที่หนังสืออ้างอิง",
        "example": "๑๐ มกราคม ๒๕๖๙",
        "required": True,
        "category": ["หนังสือภายใน"],
    },
    "REFERENCE_SUBJECT": {
        "description": "เรื่องของหนังสืออ้างอิง",
        "example": "แผนการปฏิบัติงานตรวจสอบและกำกับดูแลประจำปี 2567",
        "required": True,
        "category": ["หนังสือภายใน"],
    },
    "APPROVAL_DETAILS": {
        "description": "รายละเอียดที่ได้รับความเห็นชอบ (ต่อจาก 'ได้รับความเห็นชอบ')",
        "example": "แผนปฏิบัติงานตรวจสอบและกำกับดูแลประจำปี ๒๕๖๗ ของสำนักงาน กสทช. เขต ๒๓ โดย ผภภ. 23",
        "required": True,
        "category": ["หนังสือภายใน"],
    },
    "REQUEST_ACTION": {
        "description": "การกระทำที่ขออนุมัติ (ต่อจาก 'จึงขออนุมัติ')",
        "example": "ให้พนักงาน ภภ. 23 เดินทางไปปฏิบัติหน้าที่ตรวจสอบคลื่นความถี่",
        "required": True,
        "category": ["หนังสือภายใน"],
    },
    "DATE_RANGE": {
        "description": "ช่วงวันที่ปฏิบัติงาน",
        "example": "20 – 22 กุมภาพันธ์ 2567",
        "required": True,
        "category": ["หนังสือภายใน"],
    },
    "LOCATION": {
        "description": "สถานที่/พื้นที่ปฏิบัติงาน",
        "example": "จังหวัดบุรีรัมย์ และพื้นที่ใกล้เคียง",
        "required": True,
        "category": ["หนังสือภายใน"],
    },
    "STAFF_1": {
        "description": "ชื่อ-ตำแหน่งพนักงานคนที่ 1",
        "example": "นายสมชาย ใจดี       ตำแหน่ง นตป. ก1",
        "required": True,
        "category": ["หนังสือภายใน"],
    },
    "STAFF_2": {
        "description": "ชื่อ-ตำแหน่งพนักงานคนที่ 2",
        "example": "นายสมศักดิ์ รักงาน   ตำแหน่ง นตป. ก2",
        "required": False,
        "category": ["หนังสือภายใน"],
    },
    "STAFF_3": {
        "description": "ชื่อ-ตำแหน่งพนักงานคนที่ 3",
        "example": "นางสาวสมหญิง ขยัน  ตำแหน่ง นตป. ก3",
        "required": False,
        "category": ["หนังสือภายใน"],
    },
    "REQUEST_DETAILS": {
        "description": "รายละเอียดสิ่งที่ขออนุมัติ/ขอพิจารณา (ใช้กรณีไม่มีรายชื่อพนักงาน)",
        "example": "2.1 เพื่อให้การปฏิบัติงานเป็นไปด้วยความเรียบร้อย จึงขออนุมัติ...",
        "required": False,
        "category": ["หนังสือภายใน"],
    },
    "FACTS_AND_FINDINGS": {
        "description": "ข้อเท็จจริงและผลการดำเนินการ",
        "example": "สำนักงาน กสทช. เขต 23 ได้ดำเนินการตรวจสอบ... สรุปผลดังนี้",
        "required": True,
        "category": ["หนังสือภายใน"],
    },
    "PURPOSE": {
        "description": "วัตถุประสงค์ (ต่อจาก 'จึงเรียนมาเพื่อโปรด')",
        "example": "พิจารณาอนุมัติ",
        "required": True,
        "category": ["หนังสือภายใน", "หนังสือภายนอก"],
    },
    # External letter specific
    "SENDER_ADDRESS": {
        "description": "ที่อยู่ผู้ส่ง (ด้านบนหนังสือ)",
        "example": "สำนักงาน กสทช. ๘๗ ถนนพหลโยธิน ซอย ๘ แขวงสามเสนใน เขตพญาไท กรุงเทพฯ ๑๐๔๐๐",
        "required": False,
        "category": ["หนังสือภายนอก"],
    },
    "REFERENCE_LINE": {
        "description": "อ้างถึง (ถ้ามี)",
        "example": "อ้างถึง หนังสือบริษัท ทรู มูฟ ที่ TUC/2025/001 ลงวันที่ 16 มกราคม 2568",
        "required": False,
        "category": ["หนังสือภายนอก"],
    },
    "ATTACHMENT_LINE": {
        "description": "สิ่งที่ส่งมาด้วย (ถ้ามี)",
        "example": "สิ่งที่ส่งมาด้วย ข้อมูลเสาส่งสัญญาณ จำนวน ๖ ต้น",
        "required": False,
        "category": ["หนังสือภายนอก"],
    },
    "INTRO_PARAGRAPH": {
        "description": "ย่อหน้าเปิดเรื่อง",
        "example": "ตามหนังสือที่อ้างถึง บริษัท... ประสบปัญหา... ความละเอียดแจ้งแล้ว นั้น",
        "required": True,
        "category": ["หนังสือภายนอก"],
    },
    "BODY_PARAGRAPHS": {
        "description": "เนื้อหาหลัก",
        "example": "สำนักงาน กสทช. ขอเรียนว่า... จึงขอให้ท่านดำเนินการ...",
        "required": True,
        "category": ["หนังสือภายนอก"],
    },
    "SIGNER_NAME": {
        "description": "ชื่อผู้ลงนาม",
        "example": "นายสุธีระ พึ่งธรรม",
        "required": True,
        "category": ["หนังสือภายนอก"],
    },
    "SIGNER_POSITION": {
        "description": "ตำแหน่งผู้ลงนาม",
        "example": "ผู้อำนวยการสำนักกำกับดูแลกิจการโทรคมนาคม ปฏิบัติการแทน เลขาธิการ กสทช.",
        "required": True,
        "category": ["หนังสือภายนอก"],
    },
    "CONTACT_INFO": {
        "description": "ข้อมูลติดต่อส่วนท้าย",
        "example": "ส่วนตรวจสอบและกำกับดูแล โทร. 4348",
        "required": False,
        "category": ["หนังสือภายนอก"],
    },
    # Meeting minutes specific
    "COMMITTEE_NAME": {
        "description": "ชื่อคณะกรรมการ",
        "example": "คณะกรรมการตรวจสอบและกำกับดูแล",
        "required": True,
        "category": ["รายงานการประชุม"],
    },
    "MEETING_NUMBER": {
        "description": "ครั้งที่ประชุม/ปี",
        "example": "1/2568",
        "required": True,
        "category": ["รายงานการประชุม"],
    },
    "DAY_OF_WEEK": {
        "description": "วันในสัปดาห์",
        "example": "ศุกร์",
        "required": True,
        "category": ["รายงานการประชุม"],
    },
    "MEETING_LOCATION": {
        "description": "สถานที่ประชุม",
        "example": "ห้องประชุม สำนักงาน กสทช. เขต ๒3",
        "required": True,
        "category": ["รายงานการประชุม"],
    },
    "ATTENDEES_LIST": {
        "description": "รายชื่อผู้เข้าประชุม",
        "example": "1) นางสาวธันยพัฒน์ ภาดาเพิ่มผลสมบัติ ประธานกรรมการ\n2) นายวิทวัส ตั้งประเสริฐ กรรมการ",
        "required": True,
        "category": ["รายงานการประชุม"],
    },
    "START_TIME": {
        "description": "เวลาเริ่มประชุม",
        "example": "13.30",
        "required": True,
        "category": ["รายงานการประชุม"],
    },
    "END_TIME": {
        "description": "เวลาเลิกประชุม",
        "example": "15.00",
        "required": True,
        "category": ["รายงานการประชุม"],
    },
    "AGENDA_1_CONTENT": {
        "description": "เนื้อหาวาระที่ 1",
        "example": "ประธานแจ้งให้ที่ประชุมทราบเรื่อง...",
        "required": True,
        "category": ["รายงานการประชุม"],
    },
    "RESOLUTION_1": {
        "description": "มติวาระที่ 1",
        "example": "รับทราบตามที่ประธานแจ้ง",
        "required": True,
        "category": ["รายงานการประชุม"],
    },
    "AGENDA_2_CONTENT": {
        "description": "เนื้อหาวาระที่ 2",
        "example": "เลขานุการเสนอรายงานการประชุมครั้งที่ผ่านมา",
        "required": False,
        "category": ["รายงานการประชุม"],
    },
    "RESOLUTION_2": {
        "description": "มติวาระที่ 2",
        "example": "รับรองรายงานการประชุม",
        "required": False,
        "category": ["รายงานการประชุม"],
    },
    "AGENDA_3_CONTENT": {
        "description": "เนื้อหาวาระที่ 3",
        "example": "พิจารณาเรื่อง...",
        "required": False,
        "category": ["รายงานการประชุม"],
    },
    "RESOLUTION_3": {
        "description": "มติวาระที่ 3",
        "example": "เห็นชอบ",
        "required": False,
        "category": ["รายงานการประชุม"],
    },
    "AGENDA_4_CONTENT": {
        "description": "เนื้อหาวาระที่ 4 (อื่นๆ)",
        "example": "-",
        "required": False,
        "category": ["รายงานการประชุม"],
    },
    "RESOLUTION_4": {
        "description": "มติวาระที่ 4",
        "example": "-",
        "required": False,
        "category": ["รายงานการประชุม"],
    },
}


def get_draft_template(category: str, is_request: bool = False) -> str:
    """Get the appropriate draft template for a category"""
    if category == "หนังสือภายใน":
        return DRAFT_INTERNAL_REQUEST if is_request else DRAFT_INTERNAL_REPORT
    elif category == "หนังสือภายนอก":
        return DRAFT_EXTERNAL_LETTER
    elif category == "รายงานการประชุม":
        return DRAFT_MEETING_MINUTES
    else:
        return DRAFT_INTERNAL_REPORT


def get_placeholders_for_category(category: str) -> dict:
    """Get placeholders relevant to a specific category"""
    return {
        k: v for k, v in PLACEHOLDERS.items()
        if category in v.get("category", [])
    }

# =============================================================================
# บันทึกข้อความ Examples (Internal Memo)
# =============================================================================

EXAMPLE_TRAVEL_APPROVAL = """
	บันทึกข้อความ

หน่วยงาน   สำนักงาน กสทช.เขต 23	(ส่วนงานตรวจสอบและกำกับดูแล)	   โทร. 4348

ที่ 	สทช 2203.3/	วันที่         กุมภาพันธ์ ๒๕๖7

เรื่อง	ขออนุมัติเดินทางไปปฏิบัติงานนอกที่ตั้ง

เรียน   	ผภภ. 23

๑.	เรื่องเดิม

	ตามบันทึก สำนักงาน กสทช. เขต 23 งานตรวจสอบและกำกับดูแล ที่ [เลขที่หนังสือ]   ลงวันที่ 22 มกราคม 2567 เรื่อง แผนการปฏิบัติงานตรวจสอบและกำกับดูแลประจำปี 2567 ได้รับความเห็นชอบแผนปฏิบัติงานตรวจสอบและกำกับดูแลประจำปี ๒๕๖7 ของสำนักงาน กสทช. เขต ๒๓ โดย ผภภ. 23 รายละเอียดปรากฏตามเอกสารแนบ นั้น

๒.	เรื่องเพื่อพิจารณา

	2.1	เพื่อให้การปฏิบัติงานตามข้อ ๑. เป็นไปด้วยความเรียบร้อย จึงขออนุมัติให้พนักงาน ภภ. 23 เดินทางไปปฏิบัติหน้าที่ตรวจสอบการลักลอบการให้บริการโทรคมนาคมพื้นที่ชายแดน และตรวจสอบคลื่นความถี่นอกพื้นที่ครอบคลุมของสถานีประจำที่/รีโมท ระหว่างวันที่ 20 – 22 กุมภาพันธ์ 2567  ในเขตพื้นที่จังหวัดบุรีรัมย์ และพื้นที่ใกล้เคียง โดยมีพนักงานดังนี้

	2.1.1 นายสมชาย ใจดี       ตำแหน่ง นตป. ก1
	2.1.2 นายสมศักดิ์ รักงาน   ตำแหน่ง นตป. ก2
	2.1.3 นางสาวสมหญิง ขยัน  ตำแหน่ง นตป. ก3

	จึงเรียนมาเพื่อโปรดพิจารณาอนุมัติ
"""

EXAMPLE_FREQUENCY_REPORT = """
	บันทึกข้อความ

หน่วยงาน    สำนักงาน กสทช. เขต ๒3	ส่วนตรวจสอบและกำกับดูแล	โทร. ๔34๘

ที่	สทช 2203.3/  				วันที่          พฤษภาคม 2567

เรื่อง	รายงานผลการตรวจสอบการใช้คลื่นความถี่

เรียน	อภภ. 2

๑. เรื่องเดิม

	ตามหนังสือ ศูนย์รับแจ้งเหตุฉุกเฉิน 191 ตำรวจภูธรจังหวัดชัยภูมิ ลงวันที่ 19 เมษายน 2566 แจ้งว่า ตั้งแต่เดือนมกราคม 2566 ได้มีบุคคลไม่ทราบชื่อ – สกุล และที่อยู่อาศัย เข้ามาใช้คลื่นความถี่วิทยุสื่อสารในความถี่ของศูนย์รับแจ้งเหตุฉุกเฉิน 191 ตำรวจภูธรจังหวัดชัยภูมิ ความถี่วิทยุ 152.925 MHz ความถี่หลัก และความถี่วิทยุ 153.450 MHz ความถี่รอง โดยได้มีการแอบเฝ้าฟังการสื่อสารทางราชการ พูดแทรก ก่อกวน ความละเอียดทราบแล้วนั้น

๒. ข้อเท็จจริง

	สำนักงาน กสทช. เขต 23 ได้มอบหมายให้ส่วนตรวจสอบและกำกับดูแล ดำเนินการตรวจสอบการใช้ความถี่วิทยุที่ได้รับแจ้งปัญหาการรบกวนคลื่นความถี่ มีรายละเอียดดังนี้

	2.1	ตรวจสอบด้วยสถานีตรวจสอบระบบควบคุมระยะไกลและรถยนต์ตรวจสอบคลื่นความถี่แบบชี้ทิศ ระหว่างวันที่ 9 – 24 พฤษภาคม 2566
	2.2	ลงพื้นที่ตรวจสอบ ณ จังหวัดชัยภูมิ ในห้วงระยะเวลาที่กำหนด
	2.3	การตรวจสอบด้วยสถานีตรวจสอบระบบควบคุมระยะไกล พร้อมด้วยการลงพื้นที่ตรวจสอบ ได้ตรวจพบการรบกวนการใช้งานคลื่นความถี่ 153.450 MHz

	จึงเรียนมาเพื่อโปรดทราบ และพิจารณาดำเนินการต่อไป
"""

EXAMPLE_ROYAL_RECEPTION = """
	บันทึกข้อความ

หน่วยงาน    สำนักงาน กสทช. เขต ๒3	ส่วนตรวจสอบและกำกับดูแล	โทร. ๔34๘

ที่	สทช 2203.3/  				วันที่          เมษายน 2567

เรื่อง	รายงานผลการปฏิบัติงานถวายความปลอดภัยด้านการสื่อสาร

เรียน	อภภ. 2

๑. เรื่องเดิม

	ตามหนังสือ สำนักงานจังหวัดนครราชสีมา ที่ [เลขที่หนังสือ] ลงวันที่ 3 เมษายน 2567 เรื่อง เตรียมรับเสด็จฯ สมเด็จพระกนิษฐาธิราชเจ้า กรมสมเด็จพระเทพรัตนราชสุดาฯ สยามบรมราชกุมารี เพื่อถวายความปลอดภัยด้านการสื่อสาร เนื่องด้วยสมเด็จพระกนิษฐาธิราชเจ้า กรมสมเด็จพระเทพรัตนราชสุดาฯ สยามบรมราชกุมารี เสด็จพระราชดำเนินไปพระราชทานเข็มที่ระลึกแก่ผู้บริจาคโลหิต ความละเอียดแจ้งแล้ว นั้น

๒. ข้อเท็จจริง

	สำนักงาน กสทช. เขต 23 ได้มอบหมายให้เจ้าหน้าที่ดำเนินการตรวจสอบการใช้ความถี่วิทยุเพื่อป้องกันไม่ให้เกิดปัญหาการรบกวนคลื่นความถี่ที่ใช้ในการถวายความปลอดภัยด้านสื่อสารดังกล่าวแล้ว สรุปได้ดังนี้

	2.1 ได้ประสานการดำเนินการกับกองอำนวยการร่วมถวายความปลอดภัยประจำพื้นที่
	2.2 ได้ประสานงานกับผู้ประกอบการเคเบิ้ลทีวีในพื้นที่เพื่อให้ระงับการใช้งานช่องความถี่ที่อาจรบกวน
	2.3 ดำเนินการตรวจสอบตามเส้นทางเสด็จและสถานที่ต่างๆ ผลการตรวจสอบไม่พบปัญหาการรบกวนแต่อย่างใด

	จึงเรียนมาเพื่อโปรดทราบ
"""

EXAMPLE_ALLOCATION_REPORT = """
	บันทึกข้อความ

หน่วยงาน    สำนักงาน กสทช. เขต ๒3	ส่วนตรวจสอบและกำกับดูแล	โทร. ๔34๘

ที่	สทช 2203.3/  					  วันที่          กุมภาพันธ์ ๒๕๖7

เรื่อง	รายงานผลการตรวจสอบการใช้คลื่นความถี่เพื่อประกอบการพิจารณาจัดสรรคลื่นความถี่

เรียน	อภภ. 2

๑.  เรื่องเดิม

	ตามบันทึก ด่วนที่สุด สำนักการอนุญาตวิทยุคมนาคม 1 (คท. 1) ที่ สทช ๒๔09/131 ลงวันที่ 30 มกราคม 2567 เรื่อง ตรวจสอบการใช้งานคลื่นความถี่ของการไฟฟ้าส่วนภูมิภาค ขอความอนุเคราะห์ตรวจสอบการใช้คลื่นความถี่เพื่อให้เป็นไปตามประกาศ กสทช. ความละเอียดแจ้งแล้ว นั้น

๒. ข้อเท็จจริง

	สำนักงาน กสทช. เขต 23 ได้ดำเนินการตรวจสอบการใช้คลื่นความถี่ในย่าน 137 – 174 MHz จำนวน 15 ความถี่ ในที่ตั้งสำนักงานฯ และใช้สถานีตรวจสอบการใช้ความถี่วิทยุระบบควบคุมระยะไกล ในเขตพื้นที่รับผิดชอบ ระหว่างวันที่ 30 มกราคม – 2 กุมภาพันธ์ ๒๕๖7 เรียบร้อยแล้ว ซึ่งผลการตรวจสอบไม่พบการใช้งานบนคลื่นความถี่ที่ดำเนินการตรวจสอบแต่อย่างใด (รายละเอียดปรากฏตามเอกสารแนบ)

	จึงเรียนมาเพื่อโปรดทราบ และพิจารณาดำเนินการต่อไป จะขอบคุณยิ่ง
"""

EXAMPLE_DESTRUCTION_REPORT = """
	บันทึกข้อความ

หน่วยงาน    สำนักงาน กสทช. เขต ๒3	ส่วนตรวจสอบและกำกับดูแล	โทร. ๔34๘

ที่	สทช 2203.3/  					  วันที่          มีนาคม ๒๕๖7

เรื่อง	รายงานผลการตรวจสอบข้อมูลและเอกสารหลักฐานทุบทำลายเครื่องส่งวิทยุกระจายเสียง

เรียน	อภภ. ๒

1.	เรื่องเดิม

	ตามบันทึกสำนัก ปส. ด่วนที่สุด ที่ สทช 2304/442 ลงวันที่ 22 กุมภาพันธ์ 2567 เรื่อง ขอความอนุเคราะห์ตรวจสอบข้อมูลและเอกสารหลักฐานการทำลายเครื่องวิทยุกระจายเสียง ให้เป็นที่ประจักษ์ทางกายภาพ ความละเอียดแจ้งแล้ว นั้น

๒.	ข้อเท็จจริง

	สำนักงาน กสทช. เขต 23 ได้ดำเนินการตรวจสอบข้อมูลและเอกสารหลักฐานการทำลายเครื่องวิทยุกระจายเสียง ของผู้ทดลองออกอากาศในพื้นที่ รวมทั้งสิ้น 13 สถานี เรียบร้อยแล้ว ขอเรียนแจ้งสรุปผลการตรวจ ดังนี้

	2.1	ปรากฏพบการยื่นคำร้องขอทำลายเครื่องวิทยุกระจายเสียง จำนวน 1 สถานี
	2.2	ไม่ปรากฏพบการยื่นคำร้องขอทำลายเครื่องวิทยุกระจายเสียง จำนวน 12 สถานี

	จึงเรียนมาเพื่อโปรดพิจารณาดำเนินการในส่วนที่เกี่ยวข้องต่อไป จักขอบคุณยิ่ง


(นายไพจิตร ภูสีอ่อน)
ผภภ. 23
"""

EXAMPLE_STATION_REPORT = """
	บันทึกข้อความ

หน่วยงาน    สำนักงาน กสทช. เขต ๒3	ส่วนตรวจสอบและกำกับดูแล	โทร. 4413, ๔415

ที่	สทช 2203.3/  				วันที่          พฤษภาคม 2567

เรื่อง	รายงานผลการตรวจสอบและติดตามการดำเนินการตามมติที่ประชุม กสทช. ของสถานีวิทยุกระจายเสียง

เรียน	อภภ.2

1. เรื่องเดิม

	ตามบันทึก สำนัก คส. ที่ สทช 2306/312 ลงวันที่ 26 เมษายน 2567 เรื่อง ขอให้ตรวจสอบและติดตามการดำเนินการตามมติที่ประชุม กสทช. ของสถานีวิทยุกระจายเสียง ขอความอนุเคราะห์ให้ตรวจสอบและติดตามการดำเนินการตามมติที่ประชุม กสทช. ความละเอียดแจ้งแล้ว นั้น

2. ข้อเท็จจริง

	สำนักงาน กสทช. เขต 23 ได้ดำเนินการตรวจสอบสถานีดังกล่าวแล้ว สรุปผลการตรวจสอบได้ ดังนี้

	2.1	ชื่อสถานีที่ตรวจสอบ : สถานีวิทยุกระจายเสียง ชุมชนคนพระทองคำ รหัสสถานี 05520049 ความถี่ 103.00 MHz
	2.2	ตรวจสอบไม่พบสายอากาศติดตั้งใช้งานภายในบริเวณสถานี และตรวจสอบไม่พบการใช้คลื่นความถี่ในการออกอากาศแต่อย่างใด
	2.3	สถานีฯ ได้ดำเนินการรื้อถอนสายอากาศและอุปกรณ์ที่ใช้ในการออกอากาศ และได้ทุบทำลายเครื่องวิทยุคมนาคม ตามมติ กสทช. เรียบร้อยแล้ว

	จึงเรียนมาเพื่อโปรดพิจารณาดำเนินการต่อไป จะขอบคุณยิ่ง


(นายไพจิตร ภูสีอ่อน)
ผภภ. 23
"""

EXAMPLE_INQUIRY_REPORT = """
	บันทึกข้อความ

หน่วยงาน    สำนักงาน กสทช. เขต ๒3	ส่วนตรวจสอบและกำกับดูแล	โทร. ๔415

ที่	สทช 2203.3/  				วันที่          เมษายน 2567

เรื่อง	ขอสอบถามข้อมูลที่เกี่ยวข้องกับระบบการใช้โทรศัพท์แบบ VOIP

เรียน	อปท.2  ผ่าน  อภภ.2

	ตามหนังสือ สถานีตำรวจภูธรวังน้ำเขียว ที่ ตช 0018 (นม).32/731 ลงวันที่ 2 เมษายน 2567 เรื่อง ขอทำการสอบถามข้อมูลและระบบการใช้โทรศัพท์แบบ VOIP ได้ขอความอนุเคราะห์สำนักงาน กสทช. เขต 23 ให้ข้อมูลกรณีมีหมายเลขโทรศัพท์ที่เป็นลักษณะการเรียกจากโทรศัพท์แบบ VOIP โดยสอบถามถึงรูปแบบการทำงาน วิธีการใช้งาน และข้อมูลระบบ อุปกรณ์ที่เกี่ยวข้อง เพื่อประกอบการพิจารณาข้อเท็จจริงในสำนวน ความละเอียดแจ้งแล้ว นั้น

	สำนักงาน กสทช. เขต 23 พิจารณาแล้วเห็นว่า สำนักการอนุญาตประกอบกิจการโทรคมนาคม 2 (สำนัก ปท.2) มีขอบเขตหน้าที่เกี่ยวข้องกับประเด็นดังกล่าวข้างต้น อันจะเป็นประโยชน์ต่อการให้ข้อเท็จจริง ในการนี้ เพื่อให้การตอบข้อสักถามเป็นไปอย่างครบถ้วน และถูกต้อง จึงใคร่ขอความอนุเคราะห์สำนัก ปท.2 ให้ข้อมูลตามที่ร้องขอ เพื่อประกอบการพิจารณาคดีต่อไป

	จึงเรียนมาเพื่อโปรดพิจารณาดำเนินการต่อไป จะขอบคุณยิ่ง


(นายไพจิตร ภูสีอ่อน)
ผภภ. 23
"""

EXAMPLE_DESTRUCTION_COVER = """
	บันทึกข้อความ

หน่วยงาน   สำนักงาน กสทช เขต 23     งานตรวจสอบและกำกับดูแล        โทร 4413

ที่  สทช 2203.๓/	 วันที่       มกราคม  2568

เรื่อง   ขอนำส่งเอกสารหลักฐานการทำลายเครื่องส่งวิทยุกระจายเสียง

เรียน  อขส. ผ่าน อภภ. ๒

	ตามใบนำส่งหนังสือภายนอก เรื่อง ขอทำลายเครื่องส่งวิทยุกระจายเสียง แจ้งต่อกรณีการทำลายเครื่องส่งวิทยุกระจายเสียงระบบ FM ที่อยู่ในครอบครองให้ไม่สามารถใช้การได้ ซึ่งได้รับอนุญาตทดลองประกอบกิจการวิทยุกระจายเสียง ประเภทบริการธุรกิจ ความละเอียดแจ้งแล้ว นั้น

	สำนักงาน กสทช. เขต 23 ได้ตรวจสอบเอกสารประกอบการทำลายเครื่องส่งวิทยุกระจายเสียงดังกล่าวเรียบร้อยแล้ว โดยคำขอทำลายเครื่องส่งวิทยุกระจายเสียง ได้มีเจ้าหน้าที่ของรัฐรับรองเป็นประจักษ์พยานในกิจกรรมการทำลายเครื่องส่งวิทยุกระจายเสียงดังกล่าว พร้อมแนบเอกสารหลักฐานที่เกี่ยวข้อง ในการนี้ เพื่อให้เป็นไปตามกระบวนการในการพิจารณายกเลิกใบอนุญาตต่างๆ จึงเห็นควรแจ้งให้สำนักที่เกี่ยวข้องดำเนินการตามขั้นตอนต่อไป

	จึงเรียนมาเพื่อโปรดพิจารณายกเลิกใบอนุญาต และดำเนินการในส่วนที่เกี่ยวข้องต่อไป จะขอบคุณยิ่ง

(นางสาวปาณิดล ศิริวัฒน์)
ผภภ.23
"""

EXAMPLE_MEETING_INVITATION = """
	บันทึกข้อความ

หน่วยงาน   สำนักงาน กสทช. ภาค 2 (ส่วนตรวจสอบและกำกับดูแล) โทร. 4310

ที่  สทช 2203/ ๘๐                    วันที่  ๑๗ มกราคม 2568

เรื่อง   ขอแจ้งแผนตรวจสอบสถานีวิทยุคมนาคมและการให้บริการโทรคมนาคมบริเวณชายแดน ประจำปี 2568

เรียน ผภภ.๒ (นภ.) , ผภภ.๒ (บภ.) , ผภภ.22 - 25

	ตาม บันทึก สำนักกิจการภูมิภาค ที่ สทช 2201/361 ลงวันที่ 26 มีนาคม 2567 เรื่อง อนุมัติแผนการปฏิบัติงานตรวจสอบสถานีวิทยุคมนาคมและการให้บริการโทรคมนาคมบริเวณชายแดน เพื่อเป็นการส่งเสริมนโยบายป้องกันและปราบปรามการลักลอบให้บริการโทรคมนาคม รวมถึงการลักลอบใช้โครงข่ายโทรคมนาคมบริเวณชายแดนในการก่ออาชญากรรมทางเทคโนโลยีให้เป็นไปอย่างมีประสิทธิภาพและครอบคลุมทั่วทุกพื้นที่รับผิดชอบ นั้น

	ภภ.2 (ส่วนตรวจสอบและกำกับดูแล) ขอเรียนว่า เพื่อให้การปฏิบัติงานตรวจสอบสถานีวิทยุคมนาคมและการให้บริการโทรคมนาคมบริเวณชายแดน สอดคล้องและเป็นไปตามนโยบาย จึงขอนำส่งแผนการตรวจสอบฯ และขอเชิญ ผภภ.22 -25, ผภภ.2 หรือผู้ปฏิบัติงานที่เกี่ยวข้องเข้าร่วมการประชุม ในวันจันทร์ที่ 20 มกราคม 2568 เวลา 13.30 น. ผ่านระบบ Webex (รายละเอียดแผนการตรวจสอบ ปรากฏตามเอกสารแนบ)

	จึงเรียนมาเพื่อโปรดเข้าร่วมประชุมตามวัน และเวลาดังกล่าวต่อไปด้วย จะขอบคุณมาก


(นายสัญญา กระจ่างศรี)
อภภ. 2
"""

EXAMPLE_MEETING_MINUTES = """
รายงานการประชุม

คณะกรรมการ [ชื่อคณะกรรมการ]

ครั้งที่ 1/2568 ในวันศุกร์ที่ 24 มกราคม 2568 เวลา 13.30 น.

ณ ห้องประชุม สำนักงาน กสทช. เขต ๒3

ผู้เข้าประชุม
1) นางสาวธันยพัฒน์	ภาดาเพิ่มผลสมบัติ	ประธานกรรมการ
2) นางสาวภริตา	วิศษ	กรรมการ
3) นายวิทวัส	ตั้งประเสริฐ 	กรรมการและเลขานุการ

เริ่มประชุมเวลา  13.30 น.

ประธาน กล่าวเปิดการประชุม ตามระเบียบวาระ ดังนี้

ระเบียบวาระที่ ๑ เรื่องที่ประธานแจ้งให้ที่ประชุมทราบ
[เนื้อหาวาระที่ 1]

มติที่ประชุม	รับทราบตามที่ประธานแจ้ง

ระเบียบวาระที่ ๒ เรื่องรับรองรายงานการประชุม
[เนื้อหาวาระที่ 2]

มติที่ประชุม  	ไม่มีรับรองรายงานการประชุม เนื่องจากเป็นการประชุมครั้งแรก

ระเบียบวาระที่ ๓ เรื่องเสนอเพื่อทราบและพิจารณา
[เนื้อหาวาระที่ 3]

มติที่ประชุม	รับทราบและเห็นชอบ

ระเบียบวาระที่ ๔ เรื่องอื่น ๆ พิจารณา

มติที่ประชุม                 -

เลิกประชุมเวลา ๑5.00 น.
"""

# =============================================================================
# หนังสือภายนอก Examples (External Letter)
# =============================================================================

EXAMPLE_JOINT_INSPECTION = """
เรื่อง ขอเรียนเชิญร่วมตรวจสอบสัญญาณรบกวนการให้บริการระบบ ๔G คลื่นความถี่ ๗๐๐ MHz

เรียน ผู้จัดการออกแบบและดูแลระบบคลื่นสื่อสารโทรคมนาคม ภาคตะวันออกเฉียงเหนือตอนล่าง
      บริษัท ทรู มูฟ เอช ยูนิเวอร์แซล คอมมิวนิเคชั่น จํากัด

อ้างถึง หนังสือบริษัท ทรู มูฟ เอช ยูนิเวอร์แซล คอมมิวนิเคชั่น จํากัด ที่ TUC/NOE๒/๒๐๒๕/JAN/๐๐๑
        ลงวันที่ ๑๖ มกราคม ๒๕๖๘

	ตามหนังสือที่อ้างถึง บริษัท ทรู มูฟ เอช ยูนิเวอร์แซล คอมมิวนิเคชั่น จํากัด ประสบปัญหาด้านคุณภาพการให้บริการโทรศัพท์เคลื่อนที่ระบบ ๗๐๐ MHz ในพื้นที่จังหวัดบุรีรัมย์ ซึ่งคาดว่าอาจจะเกิดจากอุปกรณ์ส่งสัญญาณวิทยุ ความละเอียดแจ้งแล้ว นั้น

	สํานักงาน กสทช. เขต ๒๓ ขอเรียนว่า ในวันที่ ๒๓ มกราคม ๒๕๖๘ ได้ดําเนินการตรวจสอบบริเวณโดยรอบพื้นที่ร้องเรียนในเบื้องต้นแล้ว พบว่า มีการแพร่คลื่นความถี่ ในฮาโมนิกส์ที่ ๗ ของคลื่นความถี่ ๑๐๐.๗๕ MHz

	ในการนี้ เพื่อให้การตรวจสอบและการดําเนินการแก้ไขปัญหาการรบกวนเป็นไปด้วยความเรียบร้อย สํานักงาน กสทช. เขต ๒๓ ขอนัดหมายและเรียนเชิญท่าน และ/หรือ ผู้แทน ตรวจสอบสัญญาณรบกวนการให้บริการระบบ ๔G คลื่นความถี่ ๗๐๐ MHz ร่วมกับสํานักงาน กสทช. เขต ๒๓ ในวันที่ ๓๐ มกราคม ๒๕๖๘ ณ สถานที่ที่กำหนด

	จึงเรียนมาเพื่อโปรดพิจารณาให้ความอนุเคราะห์เข้าร่วมการตรวจสอบต่อไป

ขอแสดงความนับถือ
"""

EXAMPLE_TOWER_REMOVAL = """
สำนักงาน กสทช. ๘๗ ถนนพหลโยธิน ซอย ๘ แขวงสามเสนใน เขตพญาไท กรุงเทพฯ ๑๐๔๐๐

๗ กุมภาพันธ์ ๒๕๖๘

เรื่อง ขอให้ดำเนินการแก้ไขหรือรื้อถอนเสาส่งสัญญาณในบริเวณพื้นที่จังหวัดกาญจนบุรี

เรียน กรรมการผู้จัดการใหญ่บริษัท โทรคมนาคมแห่งชาติจำกัด (มหาชน)

สิ่งที่ส่งมาด้วย ข้อมูลเสาส่งสัญญาณ จำนวน ๖ ต้น

	ด้วยสำนักงานคณะกรรมการกิจการกระจายเสียง กิจการโทรทัศน์ และกิจการโทรคมนาคมแห่งชาติ (สำนักงาน กสทช.) ได้ดำเนินการตรวจสอบการแพร่สัญญาณและคุณภาพสัญญาณของสถานีฐานโทรศัพท์เคลื่อนที่ (Mobile Base Station) บริเวณชายแดนประเทศไทย – สาธารณรัฐแห่งสหภาพเมียนมา จังหวัดกาญจนบุรีตามมาตรการระงับบริการโทรคมนาคมบริเวณแนวชายแดนที่มีความเสี่ยง นั้น

	เพื่อเป็นการกำกับดูแลการประกอบกิจการโทรคมนาคม รวมถึงเป็นการยกระดับการตรวจสอบและแก้ไขปัญหาการก่ออาชญากรรมทางเทคโนโลยี สำนักงาน กสทช. จึงขอให้ท่านดำเนินการ ดังนี้

	๑. แก้ไขหรือรื้อถอนเสาส่งสัญญาณหรือระบบไฟฟ้าของสถานีฐานโทรศัพท์เคลื่อนที่ตามมาตรการที่สำนักงาน กสทช. กำหนด รายละเอียดปรากฏตามสิ่งที่ส่งมาด้วย และรายงานผลภายหลังจากดำเนินการแล้วเสร็จ
	๒. ขอให้ตรวจสอบคุณภาพสัญญาณเพื่อไม่ให้เกิดความเดือดร้อนของประชาชนในพื้นที่

	จึงเรียนมาเพื่อโปรดดำเนินการให้แล้วเสร็จภายในระยะเวลาที่กำหนด และนำส่งรายงานผลการดำเนินการให้สำนักงาน กสทช. ทราบต่อไปด้วย จะขอบคุณยิ่ง

ขอแสดงความนับถือ

(นายสุธีระ พึ่งธรรม)
ผู้อำนวยการสำนักกำกับดูแลกิจการโทรคมนาคม ปฎิบัติการแทน เลขาธิการ กสทช.
"""

EXAMPLE_SIGNAL_EXPANSION = """
เรื่อง  ขยายสัญญาณโทรศัพท์เคลื่อนที่และอินเตอร์เน็ต

เรียน  หัวหน้าสำนักปฏิบัติการด้านเทคนิคภาคตะวันออกเฉียงเหนือ บริษัท แอดวานซ์ ไวร์เลส เน็ทเวอร์ค จำกัด

	ตามหนังสือจังหวัดนครราชสีมา ด่วนที่สุด ที่ นม 0017.3/ว7743 ลงวันที่ 21 พฤศจิกายน 2567 เรื่อง เตรียมการรับเสด็จฯ สมเด็จพระกนิษฐาธิราชเจ้า กรมสมเด็จพระเทพรัตนราชสุดาฯ สยามบรมราชกุมารี ด้วยสมเด็จพระกนิษฐาธิราชเจ้า กรมสมเด็จพระเทพรัตนราชสุดา เจ้าฟ้ามหาจักรีสิรินธร มหาวชิราลงกรณวรราชภักดี สิริกิจการิณีพีรยพัฒน รัฐสีมาคุณากรปิยชาติ สยามบรมราชกุมารี เสด็จพระราชดำเนินทรงเปิดงาน ความละเอียดแจ้งแล้ว นั้น

	ดังนั้นเพื่อให้การใช้งานของผู้ใช้บริการโทรศัพท์เคลื่อนที่และอินเตอร์เน็ต เป็นไปอย่างมีประสิทธิภาพ จึงขอความอนุเคราะห์จากท่านดำเนินการขยายสัญญาณโทรศัพท์เคลื่อนที่และอินเตอร์เน็ตให้สามารถรองรับการใช้งานของผู้ใช้บริการ ณ สถานที่ที่กำหนด ทั้งนี้มอบหมายให้เจ้าหน้าที่ที่เกี่ยวข้องเป็นผู้ประสานงาน

	จึงเรียนมาเพื่อโปรดพิจารณาดำเนินการต่อไปด้วย จะขอบคุณยิ่ง

ขอแสดงความนับถือ

(นายไพจิตร ภูสีอ่อน)
ผู้อำนวยการสำนักงานคณะกรรมการกิจการกระจายเสียง กิจการโทรทัศน์
และกิจการโทรคมนาคมแห่งชาติ เขต 23 ปฏิบัติการแทน
เลขาธิการ กสทช.
"""

# =============================================================================
# Template Registry
# =============================================================================

TEMPLATES = {
    # บันทึกข้อความ subtypes
    "ขออนุมัติเดินทาง": {
        "name": "ขออนุมัติเดินทาง",
        "category": "บันทึกข้อความ",
        "description": "ขออนุมัติเดินทางไปปฏิบัติงานนอกที่ตั้ง",
        "example": EXAMPLE_TRAVEL_APPROVAL,
        "key_features": [
            "หน่วยงาน + ส่วนงาน + โทร.",
            "๑. เรื่องเดิม - อ้างอิงแผนงาน/บันทึกเดิม",
            "๒. เรื่องเพื่อพิจารณา - รายละเอียดการเดินทาง",
            "2.1.1, 2.1.2 เป็นรายชื่อพนักงาน",
        ],
    },
    "รายงานตรวจคลื่นความถี่": {
        "name": "รายงานตรวจคลื่นความถี่",
        "category": "บันทึกข้อความ",
        "description": "รายงานผลการตรวจสอบการใช้คลื่นความถี่",
        "example": EXAMPLE_FREQUENCY_REPORT,
        "key_features": [
            "๑. เรื่องเดิม - อ้างอิงหนังสือร้องเรียน/แจ้ง",
            "๒. ข้อเท็จจริง - สรุปผลการตรวจสอบ",
            "2.1, 2.2, 2.3 เป็นขั้นตอนการตรวจสอบ",
        ],
    },
    "รายงานรับเสด็จ": {
        "name": "รายงานรับเสด็จ",
        "category": "บันทึกข้อความ",
        "description": "รายงานผลการปฏิบัติงานถวายความปลอดภัยด้านการสื่อสาร",
        "example": EXAMPLE_ROYAL_RECEPTION,
        "key_features": [
            "๑. เรื่องเดิม - อ้างอิงหนังสือจังหวัด",
            "๒. ข้อเท็จจริง - สรุปการปฏิบัติงาน",
            "ใช้ราชาศัพท์ที่เหมาะสม",
        ],
    },
    "รายงานตรวจจัดสรร": {
        "name": "รายงานตรวจจัดสรร",
        "category": "บันทึกข้อความ",
        "description": "รายงานผลการตรวจสอบเพื่อประกอบการพิจารณาจัดสรรคลื่นความถี่",
        "example": EXAMPLE_ALLOCATION_REPORT,
        "key_features": [
            "๑. เรื่องเดิม - อ้างอิงบันทึกขอตรวจสอบ",
            "๒. ข้อเท็จจริง - ผลการตรวจสอบความถี่",
            "ระบุย่านความถี่และจำนวนที่ตรวจ",
        ],
    },
    "รายงานทุบทำลายเครื่อง": {
        "name": "รายงานทุบทำลายเครื่อง",
        "category": "บันทึกข้อความ",
        "description": "รายงานผลการตรวจสอบการทำลายเครื่องส่งวิทยุกระจายเสียง",
        "example": EXAMPLE_DESTRUCTION_REPORT,
        "key_features": [
            "๑. เรื่องเดิม - อ้างอิงบันทึกขอตรวจสอบ",
            "๒. ข้อเท็จจริง - สรุปจำนวนสถานีที่ตรวจ",
            "2.1, 2.2 แยกพบ/ไม่พบการยื่นคำร้อง",
        ],
    },
    "รายงานตรวจสถานี": {
        "name": "รายงานตรวจสถานี",
        "category": "บันทึกข้อความ",
        "description": "รายงานผลการตรวจสอบสถานีวิทยุกระจายเสียง",
        "example": EXAMPLE_STATION_REPORT,
        "key_features": [
            "๑. เรื่องเดิม - อ้างอิงมติ กสทช.",
            "๒. ข้อเท็จจริง - ผลการตรวจสอบสถานี",
            "2.1 ชื่อสถานี 2.2 ผลตรวจ 2.3 สรุป",
        ],
    },
    "รายงานสอบถามข้อมูล": {
        "name": "รายงานสอบถามข้อมูล",
        "category": "บันทึกข้อความ",
        "description": "ขอสอบถามข้อมูลไปยังหน่วยงานอื่น",
        "example": EXAMPLE_INQUIRY_REPORT,
        "key_features": [
            "เรียน ผ่านผู้บังคับบัญชา",
            "อ้างอิงหนังสือขอข้อมูล",
            "ระบุสำนักที่เกี่ยวข้อง",
        ],
    },
    "ใบปะหน้าขอทำลาย": {
        "name": "ใบปะหน้าขอทำลาย",
        "category": "บันทึกข้อความ",
        "description": "ใบปะหน้านำส่งเอกสารหลักฐานการทำลายเครื่องส่ง",
        "example": EXAMPLE_DESTRUCTION_COVER,
        "key_features": [
            "อ้างอิงใบนำส่งหนังสือภายนอก",
            "ระบุรายละเอียดเครื่องส่ง (ยี่ห้อ รุ่น หมายเลข)",
            "ขอพิจารณายกเลิกใบอนุญาต",
        ],
    },
    "เชิญประชุม": {
        "name": "เชิญประชุม",
        "category": "บันทึกข้อความ",
        "description": "แจ้งแผนและเชิญประชุม",
        "example": EXAMPLE_MEETING_INVITATION,
        "key_features": [
            "อ้างอิงบันทึกอนุมัติแผน",
            "ระบุวัน เวลา สถานที่ประชุม",
            "ระบุ Webex/ช่องทางออนไลน์ถ้ามี",
        ],
    },
    "รายงานการประชุม": {
        "name": "รายงานการประชุม",
        "category": "รายงานการประชุม",
        "description": "บันทึกรายงานการประชุมคณะกรรมการ",
        "example": EXAMPLE_MEETING_MINUTES,
        "key_features": [
            "ระบุชื่อคณะกรรมการ ครั้งที่ วันเวลา สถานที่",
            "รายชื่อผู้เข้าประชุม",
            "ระเบียบวาระที่ ๑-๔ พร้อมมติที่ประชุม",
            "เวลาเริ่ม-เลิกประชุม",
        ],
    },
    # หนังสือภายนอก subtypes
    "เชิญตรวจร่วม": {
        "name": "เชิญตรวจร่วม",
        "category": "หนังสือภายนอก",
        "description": "ขอเรียนเชิญร่วมตรวจสอบสัญญาณรบกวน",
        "example": EXAMPLE_JOINT_INSPECTION,
        "key_features": [
            "เรื่อง ระบุปัญหาที่พบ",
            "อ้างถึง หนังสือร้องเรียนจากบริษัท",
            "นัดหมายวันเวลาสถานที่ตรวจร่วม",
            "ขอแสดงความนับถือ",
        ],
    },
    "ขอรื้อถอนเสา": {
        "name": "ขอรื้อถอนเสา",
        "category": "หนังสือภายนอก",
        "description": "ขอให้ดำเนินการแก้ไขหรือรื้อถอนเสาส่งสัญญาณ",
        "example": EXAMPLE_TOWER_REMOVAL,
        "key_features": [
            "ที่อยู่สำนักงาน กสทช. ด้านบน",
            "สิ่งที่ส่งมาด้วย - ข้อมูลเสา",
            "ระบุมาตรการและข้อกำหนด",
            "ลงนามโดยผู้อำนวยการสำนัก",
        ],
    },
    "ขอขยายสัญญาณ": {
        "name": "ขอขยายสัญญาณ",
        "category": "หนังสือภายนอก",
        "description": "ขอความอนุเคราะห์ขยายสัญญาณโทรศัพท์เคลื่อนที่",
        "example": EXAMPLE_SIGNAL_EXPANSION,
        "key_features": [
            "อ้างอิงหนังสือจังหวัด",
            "ระบุวัตถุประสงค์ (รับเสด็จ/งานสำคัญ)",
            "มอบหมายผู้ประสานงาน",
            "ขอแสดงความนับถือ",
        ],
    },
}


def get_template(template_type: TemplateType) -> dict:
    """Get template info by type"""
    return TEMPLATES.get(template_type, TEMPLATES["ขออนุมัติเดินทาง"])


def get_template_example(template_type: TemplateType) -> str:
    """Get example document for template type"""
    return TEMPLATES.get(template_type, TEMPLATES["ขออนุมัติเดินทาง"])["example"]


def get_template_features(template_type: TemplateType) -> list[str]:
    """Get key features for template type"""
    return TEMPLATES.get(template_type, TEMPLATES["ขออนุมัติเดินทาง"])["key_features"]


def list_templates() -> list[dict]:
    """List all available templates grouped by category"""
    return [
        {
            "type": k,
            "name": v["name"],
            "category": v["category"],
            "description": v["description"],
        }
        for k, v in TEMPLATES.items()
    ]


def list_templates_by_category() -> dict[str, list[dict]]:
    """List templates grouped by category"""
    categories = {}
    for k, v in TEMPLATES.items():
        cat = v["category"]
        if cat not in categories:
            categories[cat] = []
        categories[cat].append({
            "type": k,
            "name": v["name"],
            "description": v["description"],
        })
    return categories


def get_templates_for_category(category: str) -> list[dict]:
    """Get all templates that belong to a category (for RAG fallback)"""
    # Map high-level category to template categories
    category_mapping = {
        "หนังสือภายใน": ["บันทึกข้อความ"],
        "หนังสือภายนอก": ["หนังสือภายนอก"],
        "รายงานการประชุม": ["รายงานการประชุม"],
    }

    target_cats = category_mapping.get(category, [category])

    return [
        {
            "type": k,
            "name": v["name"],
            "example": v["example"],
            "key_features": v["key_features"],
        }
        for k, v in TEMPLATES.items()
        if v["category"] in target_cats
    ]


def get_random_example_for_category(category: str) -> str:
    """Get a random example document for a category (for few-shot prompting)"""
    import random
    templates = get_templates_for_category(category)
    if templates:
        return random.choice(templates)["example"]
    return ""


def get_all_examples_for_category(category: str) -> list[str]:
    """Get all example documents for a category"""
    templates = get_templates_for_category(category)
    return [t["example"] for t in templates]
