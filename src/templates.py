"""Thai Government Document Templates"""

from typing import Literal

TemplateType = Literal["บันทึกข้อความ", "หนังสือภายนอก"]

# =============================================================================
# บันทึกข้อความ (Internal Memo) - กสทช Format
# =============================================================================

INTERNAL_MEMO_TEMPLATE = """
                            บันทึกข้อความ

หน่วยงาน  {agency_name} ({division} โทร. {phone})
ที่  {doc_number}                       วันที่  {date}
เรื่อง  {subject}

เรียน  {recipient}

๑. เรื่องเดิม

    1.1 {background_ref}

๒. {section2_title}

    2.1 {main_content}

        {sub_items}

        {closing_phrase}

                                              ({signer_name})
                                              {signer_position}
"""

INTERNAL_MEMO_EXAMPLE = """
                            บันทึกข้อความ

หน่วยงาน  สำนักงาน กสทช.เขต 23 (งานตรวจสอบและกำกับดูแล โทร. 4413)
ที่  สทช 2203.3/001                       วันที่  20 มกราคม 2569
เรื่อง  ขออนุมัติเดินทางไปปฏิบัติงานนอกที่ตั้ง

เรียน  ผภภ. 23

๑. เรื่องเดิม

    1.1 ตามบันทึกกองตรวจสอบและกำกับดูแลกิจการกระจายเสียง ที่ สทช.
        2401/123 ลงวันที่ 15 มกราคม 2569 เรื่อง ขอความร่วมมือตรวจสอบ
        สถานีวิทยุ รายละเอียดตามเอกสารแนบ 1 นั้น

๒. เรื่องเพื่อพิจารณา

    2.1 เพื่อให้การปฏิบัติงานตามข้อ ๑. เป็นไปด้วยความเรียบร้อย
        จึงขออนุมัติให้พนักงาน ภภ. 23 เดินทางไปปฏิบัติหน้าที่ตรวจสอบ
        สถานีวิทยุชุมชน ระหว่างวันที่ 25-27 มกราคม 2569
        ในพื้นที่จังหวัดเชียงใหม่ และพื้นที่ใกล้เคียง โดยมีพนักงานดังนี้

        2.1.1 นายสมชาย ใจดี       ตำแหน่ง พนักงานปฏิบัติการระดับกลาง
        2.1.2 นายสมศักดิ์ รักงาน   ตำแหน่ง พนักงานปฏิบัติการระดับต้น
        2.1.3 นางสาวสมหญิง ขยัน  ตำแหน่ง พนักงานปฏิบัติการระดับต้น

        จึงเรียนมาเพื่อโปรดพิจารณาอนุมัติ

                                              (นายประสิทธิ์ ผลงาน)
                                              ผู้อำนวยการสำนัก กสทช. เขต 23
"""

# =============================================================================
# หนังสือภายนอก (External Letter) - Standard Government Format
# =============================================================================

EXTERNAL_LETTER_TEMPLATE = """
                              [ตราครุฑ]

ที่ {doc_number}                                {agency_name}
                                                {address_line1}
                                                {address_line2}
                                                {date}

เรื่อง  {subject}

เรียน  {recipient}

อ้างถึง  {reference}

สิ่งที่ส่งมาด้วย  {attachments}

        {paragraph1}

        {paragraph2}

        {closing_paragraph}

                                                {closing_phrase}


                                                ({signer_name})
                                                {signer_position}

{contact_dept}
โทร. {phone}
โทรสาร {fax}
"""

EXTERNAL_LETTER_EXAMPLE = """
                              [ตราครุฑ]

ที่ มท 0307/1234                                กรมการปกครอง
                                                ถนนอัษฎางค์ แขวงวัดราชบพิธ
                                                เขตพระนคร กรุงเทพมหานคร 10200
                                                15 มกราคม 2569

เรื่อง  ขอความอนุเคราะห์ข้อมูลทะเบียนราษฎร

เรียน  ผู้อำนวยการสำนักทะเบียนกลาง

อ้างถึง  หนังสือกรมการปกครอง ที่ มท 0307/5678 ลงวันที่ 10 ธันวาคม 2568

สิ่งที่ส่งมาด้วย  แบบฟอร์มขอข้อมูล จำนวน 1 ชุด

        ด้วยกรมการปกครองมีความจำเป็นต้องใช้ข้อมูลทะเบียนราษฎรเพื่อประกอบ
การดำเนินโครงการพัฒนาระบบฐานข้อมูลประชาชน ตามนโยบายรัฐบาลดิจิทัล

        ในการนี้ จึงขอความอนุเคราะห์จากท่านโปรดพิจารณาอนุมัติการเข้าถึงข้อมูล
ทะเบียนราษฎรเฉพาะส่วนที่จำเป็น ตามรายละเอียดในแบบฟอร์มที่แนบมาพร้อมนี้

        จึงเรียนมาเพื่อโปรดพิจารณาให้ความอนุเคราะห์ด้วย จักขอบคุณยิ่ง

                                                ขอแสดงความนับถือ


                                                (นายสมชาย ใจดี)
                                                อธิบดีกรมการปกครอง

กองการทะเบียน
โทร. 0 2222 3333
โทรสาร 0 2222 3334
"""

# =============================================================================
# Template Selection
# =============================================================================

TEMPLATES = {
    "บันทึกข้อความ": {
        "name": "บันทึกข้อความ (Internal Memo)",
        "description": "สำหรับติดต่อภายในหน่วยงาน - รูปแบบ กสทช.",
        "template": INTERNAL_MEMO_TEMPLATE,
        "example": INTERNAL_MEMO_EXAMPLE,
        "key_features": [
            "หน่วยงาน (ไม่ใช่ ส่วนราชการ)",
            "๑. เรื่องเดิม / ๒. เรื่องเพื่อพิจารณา",
            "เลขลำดับ: ๑. ๒. (ไทย) → 1.1, 2.1 (อารบิก) → 2.1.1 (ย่อย)",
            "ไม่มีตราครุฑ, ไม่มีที่อยู่, ไม่มีข้อมูลติดต่อท้าย",
            "2.1.1, 2.1.2 ต้องเป็นรายชื่อบุคคลเท่านั้น ไม่ใช่หัวข้อ เช่น '2.1.1 นายสมชาย ใจดี ตำแหน่ง ...'",
        ],
    },
    "หนังสือภายนอก": {
        "name": "หนังสือภายนอก (External Letter)",
        "description": "สำหรับติดต่อหน่วยงานภายนอก - รูปแบบมาตรฐาน",
        "template": EXTERNAL_LETTER_TEMPLATE,
        "example": EXTERNAL_LETTER_EXAMPLE,
        "key_features": [
            "มีตราครุฑกลางหน้า",
            "ที่ + ที่อยู่ชิดขวา",
            "อ้างถึง / สิ่งที่ส่งมาด้วย",
            "คำลงท้าย: ขอแสดงความนับถือ",
            "ข้อมูลติดต่อท้ายเอกสาร (โทร., โทรสาร)",
        ],
    },
}


def get_template(template_type: TemplateType) -> dict:
    """Get template info by type"""
    return TEMPLATES.get(template_type, TEMPLATES["บันทึกข้อความ"])


def get_template_example(template_type: TemplateType) -> str:
    """Get example document for template type"""
    return TEMPLATES.get(template_type, TEMPLATES["บันทึกข้อความ"])["example"]


def get_template_features(template_type: TemplateType) -> list[str]:
    """Get key features for template type"""
    return TEMPLATES.get(template_type, TEMPLATES["บันทึกข้อความ"])["key_features"]


def list_templates() -> list[dict]:
    """List all available templates"""
    return [
        {"type": k, "name": v["name"], "description": v["description"]}
        for k, v in TEMPLATES.items()
    ]
